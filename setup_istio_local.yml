---
  - hosts: localhost
    gather_facts: True

    pre_tasks:
      - name: Check if API is reachable       
        shell: curl -k https://127.0.0.1:8443
        register: curl
        failed_when: curl.rc != 0
        
    vars:
        istio_basedir: "{{playbook_dir}}/istio-{{istio_version}}"
        demo_app: True
        addons: False
        skydive: False
          
    roles:
      - local_cluster_up
      - istio
      - { role: demo_app, when: demo_app}
      - { role: addons, when: addons}
      - { role: skydive, when: skydive}
      